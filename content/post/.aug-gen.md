---
title: Incorporating Music Knowledge in Continual Dataset Augmentation for Music Generation
date: 2020-07-18
math: true
diagram: true
markup: mmark
---
*Alisa Liu, Alex Fang, GaÃ«tan Hadjeres, Prem Seetharaman, Bryan Pardo*

## Grading function

Here are three chorales generated by the same model.

{{< audio mp3="../../audio/bach/grading_function/54.mp3" >}}
{{< figure src="../../img/bach/54.png" title="Chorale 1" width="60%">}}
{{< audio mp3="../../audio/bach/grading_function/304.mp3" >}}
{{< figure src="../../img/bach/304.png" title="Chorale 2" width="60%">}}
{{< audio mp3="../../audio/bach/grading_function/93.mp3" >}}
{{< figure src="../../img/bach/93.png" title="Chorale 3" width="60%">}}

Which chorales did you think were better? Here are the grades of the three chorales. **Note:** Since the grade is a distance measure, *lower grades are better!*

|Chorale|Overall Grade|Note|Rhythm|Parallel Errors|Harmonic Quality|S Intervals|A Intervals|T Intervals|B Intervals|Repeated Sequence|
|----|----|----|----|----|----|----|----|----|----|----|
|1|54.026|0.314|0.413|44.835|1.645|0.923|1.344|0.988|0.948|2.617|
|2|8.386|0.167|0.327|2.031|0.567|0.640|0.498|0.720|0.996|2.440|
|3 (best)|3.893|0.301|0.199|0|0.328|0.345|0.396|0.680|0.597|1.047|

Chorale 1, while relatively short, is laden with parallel errors (especially in measure 3), which the grading function punishes. Chorale 2 has parallel octaves in measure 3 in the alto and bass voices (SATB order) starting on the second eighth note. Furthermore, it has seven D's in a row in the alto voice, which is punished by the "repeated sequence" portion of the grade. Chorale 3 contains no parallel errors.

### Paired evaluation
Want to test yourself? In each pair, one chorale was written by Bach and one was model-generated. In each pair, the grading function assigns a better grade to Bach but the decision may be challenging and time-consuming for human listeners. The answers are here[^1].

#### Pair 1
{{< audio mp3="../../audio/bach/pairs/pair_1/base_43.mp3" >}}
{{< audio mp3="../../audio/bach/pairs/pair_1/bach_24.mp3" >}}
#### Pair 2
{{< audio mp3="../../audio/bach/pairs/pair_2/bach_30.mp3" >}}
{{< audio mp3="../../audio/bach/pairs/pair_2/base_13.mp3" >}}
#### Pair 3
{{< audio mp3="../../audio/bach/pairs/pair_3/base_35.mp3" >}}
{{< audio mp3="../../audio/bach/pairs/pair_3/bach_43.mp3" >}}

## Examples from augmentative generation
Here are example generations from a model trained through the augmentative generation method we introduce in this paper, along with Bach chorales and the generations from two baselines.

### Bach
Two original Bach chorales!

BWV 297: {{< audio mp3="../../audio/bach/models/bach225.mp3" >}}
BWV 194.6: {{< audio mp3="../../audio/bach/models/bach249.mp3" >}}


### Augmentative generation
During training, augment the training dataset with all generated chorales that receive a grade better than 25% of Bach chorales.

{{< audio mp3="../../audio/bach/models/aug-gen8.mp3" >}}
{{< audio mp3="../../audio/bach/models/aug-gen26.mp3" >}}

### Baseline-none
Do not include any generated chorales in the training dataset. This is equivalent to training a model on only Bach chorales, without dataset augmentation!

{{< audio mp3="../../audio/bach/models/base8.mp3" >}}
{{< audio mp3="../../audio/bach/models/base10.mp3" >}}

### Baseline-all
During training, augment the training dataset with all generated chorales, regardless of quality.
{{< audio mp3="../../audio/bach/models/baseline5.mp3" >}}
{{< audio mp3="../../audio/bach/models/baseline6.mp3" >}}

[^1]: (1) first chorale is generated (grade: 7.98), second chorale is Bach (grade: 4.94). (2) first chorale is Bach (grade: 5.01), second chorale is generated (grade: 5.26). (3) first chorale is generated (grade: 8.76), second chorale is Bach (grade: 3.82). **Note:** Since the grade is a distance measure, *lower grades are better!*
